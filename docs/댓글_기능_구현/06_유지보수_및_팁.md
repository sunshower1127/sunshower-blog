# Phase 6: 유지보수 및 팁

giscus 댓글 시스템을 효과적으로 관리하고 활용하는 방법입니다.

---

## 댓글 관리

### GitHub Discussions에서 관리
모든 댓글은 GitHub Discussions에 저장되므로 GitHub UI에서 직접 관리할 수 있습니다.

#### 댓글 수정
1. GitHub 저장소 → Discussions 탭
2. 해당 Discussion 클릭
3. 본인 댓글 옆의 **"..."** → Edit

#### 댓글 삭제
1. GitHub 저장소 → Discussions 탭
2. 해당 Discussion 클릭
3. 본인 댓글 옆의 **"..."** → Delete

#### 스팸/악의적 댓글 처리
- **Hide**: 댓글 숨기기 (저장소 관리자만 가능)
- **Lock discussion**: Discussion 잠금 (추가 댓글 방지)
- **Block user**: 사용자 차단 (저장소 설정에서)

---

## giscus 설정 변경

### 일시적으로 댓글 비활성화

**파일**: `src/data/giscus.config.ts`

```typescript
export const giscusConfig: GiscusConfig = {
  enabled: false,  // true → false로 변경
  ...
}
```

재빌드 후 배포하면 댓글 위젯이 숨겨집니다.

---

### 카테고리 변경

#### Step 1: GitHub에서 새 카테고리 생성
1. Discussions 탭 → Categories 관리
2. 새 카테고리 생성 (예: "Blog Comments")

#### Step 2: giscus.app에서 새 설정 획득
1. https://giscus.app/ko 재방문
2. 새 카테고리 선택
3. 새로운 `data-category-id` 복사

#### Step 3: 설정 파일 업데이트
```typescript
export const giscusConfig: GiscusConfig = {
  ...
  category: 'Blog Comments',
  categoryId: 'DIC_kwDO새로운ID',
  ...
}
```

⚠️ **주의**: 카테고리를 변경하면 기존 댓글은 이전 카테고리에 남아 있습니다. 수동으로 Discussion을 이동해야 합니다.

---

### 매핑 방식 변경

#### pathname (현재 설정)
- URL 경로 기반: `/post/astro` → Discussion 생성
- **장점**: URL 변경 시 댓글도 따라감
- **단점**: URL 구조 변경 시 댓글 연결 끊김

#### title
- 포스트 제목 기반
- **장점**: URL 변경해도 제목이 같으면 댓글 유지
- **단점**: 제목 변경 시 댓글 연결 끊김

#### url
- 전체 URL 기반 (도메인 포함)
- **장점**: 정확한 매핑
- **단점**: 도메인 변경 시 댓글 연결 끊김

**변경 방법**:
```typescript
export const giscusConfig: GiscusConfig = {
  ...
  mapping: 'title',  // pathname → title로 변경
  ...
}
```

---

## 테마 커스터마이징

### 기본 테마 변경

#### 현재 설정 (자동 다크모드)
```typescript
theme: 'preferred_color_scheme'
```

#### 항상 라이트 모드
```typescript
theme: 'light'
```

#### 항상 다크 모드
```typescript
theme: 'dark'
```

#### GitHub 스타일 다크 모드
```typescript
theme: 'dark_dimmed'
```

#### 고대비 모드
```typescript
theme: 'dark_high_contrast'
```

---

### 커스텀 CSS 테마

giscus는 커스텀 CSS 테마를 지원합니다.

#### Step 1: CSS 파일 생성
`public/giscus-custom.css`:
```css
:root {
  --color-primary: #ff6b6b;
  --color-secondary: #4ecdc4;
  --color-text: #2d3436;
  --color-background: #ffffff;
}

.giscus-frame {
  color: var(--color-text);
  background: var(--color-background);
}
```

#### Step 2: 설정 변경
```typescript
theme: 'https://sunshower-blog.netlify.app/giscus-custom.css'
```

---

## 성능 최적화

### Lazy Loading (기본 활성화)
giscus는 기본적으로 lazy loading을 사용합니다.

**컴포넌트**: `src/components/Giscus.astro`
```javascript
script.setAttribute('data-loading', 'lazy')
```

- 페이지 로드 시 즉시 로드하지 않음
- 사용자가 스크롤하여 댓글 영역에 가까워질 때 로드
- 초기 페이지 로드 속도 향상

---

### 조건부 로드

특정 포스트에서만 댓글 활성화:

**파일**: `src/pages/post/[...slug].astro`

```astro
---
...
const giscusEnabled = giscusConfig.enabled && !post.data.draft
// draft 포스트에서는 댓글 비활성화
---

{giscusEnabled && <Giscus />}
```

또는 특정 카테고리에서만:
```astro
const giscusEnabled = giscusConfig.enabled && post.data.category !== 'note'
```

---

## 알림 설정

### 댓글 알림 받기

#### 방법 1: GitHub Discussions Watch
1. GitHub 저장소 페이지 상단 **Watch** 버튼 클릭
2. **Custom** → **Discussions** 체크

#### 방법 2: 개별 Discussion Subscribe
1. Discussions 탭 → 특정 Discussion 클릭
2. 오른쪽 사이드바 → **Subscribe** 버튼

#### 알림 채널
- 이메일
- GitHub 웹 알림
- GitHub 모바일 앱

---

## 댓글 백업

### 자동 백업 (GitHub 기본 제공)
- 모든 댓글은 GitHub에 저장됨
- GitHub의 백업 시스템에 의해 자동 보호

### 수동 백업

#### GraphQL API로 내보내기
GitHub GraphQL API를 사용하여 Discussions 데이터를 추출할 수 있습니다.

```graphql
query {
  repository(owner: "username", name: "sunshower-blog") {
    discussions(first: 100) {
      nodes {
        title
        body
        comments(first: 100) {
          nodes {
            body
            author {
              login
            }
            createdAt
          }
        }
      }
    }
  }
}
```

---

## 마이그레이션

### Disqus → giscus 마이그레이션

⚠️ **주의**: Disqus와 giscus 간 자동 마이그레이션은 지원되지 않습니다.

#### 옵션 1: 수동 복사
- 중요한 댓글만 GitHub Discussions에 수동 복사
- 댓글 수가 적을 때 적합

#### 옵션 2: 병행 운영
- 기존 포스트: Disqus 유지
- 새 포스트: giscus 사용
- 조건부 렌더링:
  ```astro
  {post.data.pubDate < new Date('2024-01-10') ? <Disqus /> : <Giscus />}
  ```

#### 옵션 3: 안내 메시지
- Disqus 위에 마이그레이션 안내
- 사용자에게 GitHub Discussions 링크 제공

---

## 추가 기능

### 반응(Reactions) 비활성화

```typescript
export const giscusConfig: GiscusConfig = {
  ...
  reactionsEnabled: false,  // true → false
  ...
}
```

---

### 익명 댓글 허용 (불가능)

giscus는 GitHub 인증을 **필수**로 요구합니다. 익명 댓글은 지원하지 않습니다.

**대안**:
- Disqus (익명 댓글 지원)
- Utterances (GitHub 계정 필요)
- 자체 구현 댓글 시스템

---

## 통계 및 분석

### Discussion 통계 확인

#### GitHub Insights
1. 저장소 → Insights 탭
2. Community → Discussions

#### 확인 가능한 지표
- 총 Discussion 수
- 활성 사용자 수
- 댓글 수
- 리액션 수

---

### Google Analytics 연동 (선택 사항)

giscus는 `data-emit-metadata` 옵션을 통해 이벤트를 발생시킬 수 있습니다.

**컴포넌트**: `src/components/Giscus.astro`
```javascript
script.setAttribute('data-emit-metadata', '1')  // 0 → 1

// 이벤트 리스너 추가
window.addEventListener('message', (event) => {
  if (event.origin !== 'https://giscus.app') return
  if (typeof event.data !== 'object') return
  if (event.data.giscus) {
    // Google Analytics 이벤트 전송
    gtag('event', 'giscus_interaction', {
      action: event.data.giscus.action
    })
  }
})
```

---

## 문제 해결 FAQ

### Q: 댓글이 갑자기 사라졌어요
**A**: GitHub Discussions에서 확인하세요. Discussion이 삭제되거나 잠겼을 수 있습니다.

### Q: 특정 포스트에서만 댓글이 안 보여요
**A**: 해당 포스트의 URL 경로를 확인하세요. `mapping: 'pathname'` 설정과 일치해야 합니다.

### Q: 테마가 변경되지 않아요
**A**: 브라우저 캐시를 지우고 새로고침하세요. 또는 `Ctrl + Shift + R` (강력 새로고침)

### Q: 댓글 수를 표시하고 싶어요
**A**: giscus는 기본적으로 댓글 수 API를 제공하지 않습니다. GitHub GraphQL API를 사용하여 구현할 수 있습니다.

### Q: 모바일에서 레이아웃이 깨져요
**A**: `Giscus.astro` 컴포넌트의 Tailwind 클래스 확인하세요. 특히 `px-6 sm:px-6` 등 반응형 패딩.

---

## 추가 참고 자료

### 공식 문서
- giscus 공식 사이트: https://giscus.app/ko
- giscus GitHub: https://github.com/giscus/giscus
- GitHub Discussions 가이드: https://docs.github.com/en/discussions

### 커뮤니티
- giscus Discussions: https://github.com/giscus/giscus/discussions
- Astro Discord: https://astro.build/chat

---

## 체크리스트 - 장기 운영

- [ ] GitHub Discussions watch 설정 (댓글 알림)
- [ ] 스팸 처리 방법 숙지
- [ ] 정기적인 댓글 모니터링 계획
- [ ] 백업 전략 수립 (필요시)
- [ ] 커뮤니티 가이드라인 작성 (선택)

---

## 마무리

giscus 댓글 시스템이 성공적으로 통합되었습니다! 🎉

주요 장점:
- ✅ 무료, 광고 없음
- ✅ GitHub 연동으로 데이터 소유권 확보
- ✅ 마크다운 및 코드 하이라이팅 지원
- ✅ 다크모드 자동 동기화
- ✅ 리액션 기능

지속적인 관리와 커뮤니티 참여로 블로그를 더욱 활성화하세요!

---

📄 **문서 시리즈 완료**
- [00_개요.md](./00_개요.md)
- [01_사전_준비.md](./01_사전_준비.md)
- [02_설정_파일_생성.md](./02_설정_파일_생성.md)
- [03_컴포넌트_생성.md](./03_컴포넌트_생성.md)
- [04_페이지_통합.md](./04_페이지_통합.md)
- [05_테스트_및_검증.md](./05_테스트_및_검증.md)
- **[06_유지보수_및_팁.md](./06_유지보수_및_팁.md)** ← 현재 문서
